[
  {
    "id": "new-blog-new-view",
    "title": "New Blog,New View",
    "slug": "new-blog-new-view",
    "excerpt": "test for it\n\nthis is some for test.\n\n<CustomModal triggerText=\"打开这个模态框\" title=\"这是我的模态框\">\n  你好\n</CustomModal>\n\n<InteractiveChart \n  title=\"123\"\n/>",
    "content": "# test for it\n\n## this is some for test.\n\n<CustomModal triggerText=\"打开这个模态框\" title=\"这是我的模态框\">\n  你好\n</CustomModal>\n\n<InteractiveChart \n  title=\"123\"\n/>\n",
    "date": "2025-12-19T01:43:47.717Z",
    "author": "Mer6ury"
  },
  {
    "id": "PLUGIN_SYSTEM_DEVELOPMENT",
    "title": "Quicksilver 插件系统开发文档",
    "slug": "PLUGIN_SYSTEM_DEVELOPMENT",
    "excerpt": "Quicksilver 插件系统开发文档\r\n\r\n目录\r插件系统概述\r系统架构\r插件类型和接口\rAPI 参考\r插件开发教程\r插件管理和部署\r最佳实践\r故障排除\r\n\r\n插件系统概述\r\n\r\nQuicksilver 是一个基于 Next.js...",
    "content": "\r\n# Quicksilver 插件系统开发文档\r\n\r\n## 目录\r\n\r\n1. [插件系统概述](#插件系统概述)\r\n2. [系统架构](#系统架构)\r\n3. [插件类型和接口](#插件类型和接口)\r\n4. [API 参考](#api-参考)\r\n5. [插件开发教程](#插件开发教程)\r\n6. [插件管理和部署](#插件管理和部署)\r\n7. [最佳实践](#最佳实践)\r\n8. [故障排除](#故障排除)\r\n\r\n## 插件系统概述\r\n\r\nQuicksilver 是一个基于 Next.js 的博客系统，其核心特性之一是灵活的插件系统。这个系统允许开发者通过插槽机制在应用的预定义位置注入 UI 组件，从而扩展应用功能而无需修改核心代码。\r\n\r\n### 核心特性\r\n\r\n- **插槽式架构**: 通过预定义的插槽位置注入组件\r\n- **类型安全**: 使用 TypeScript 提供完整的类型支持\r\n- **生命周期管理**: 支持插件的加载、初始化和卸载\r\n- **热插拔**: 支持运行时启用/禁用插件\r\n- **数据库存储**: 插件配置和数据持久化\r\n- **管理界面**: 提供完整的插件管理界面\r\n\r\n### 插件的基本结构\r\n\r\n每个插件都是一个 JavaScript/TypeScript 模块，导出一个符合 `ClientPlugin` 接口的对象：\r\n\r\n```typescript\r\nexport const MyPlugin: ClientPlugin = {\r\n    id: 'my-plugin',\r\n    name: '我的插件',\r\n    description: '插件描述',\r\n    components: {\r\n        'slot-name': MyComponent,\r\n    },\r\n    onLoad: () => {\r\n        console.log('插件已加载');\r\n    }\r\n};\r\n```\r\n\r\n## 系统架构\r\n\r\n插件系统由以下几个核心部分组成：\r\n\r\n### 1. 核心类型定义\r\n\r\n位置: `src/lib/plugins/types.ts`\r\n\r\n定义了插件系统的核心类型，包括：\r\n- `PluginSlot`: 可用的插件插槽类型\r\n- `ClientPlugin`: 客户端插件接口\r\n- `PluginRegistry`: 插件注册表类型\r\n\r\n### 2. 插件注册表\r\n\r\n位置: `src/lib/plugins/registry.ts`\r\n\r\n包含所有可用插件的注册表，系统启动时会在这里加载所有插件。\r\n\r\n### 3. 插件上下文\r\n\r\n位置: `src/lib/plugins/context.tsx`\r\n\r\n提供插件系统的 React 上下文，管理插件的状态和生命周期。\r\n\r\n### 4. 插件槽组件\r\n\r\n位置: `src/components/PluginSlot.tsx`\r\n\r\n用于在应用中渲染特定插槽的所有插件组件。\r\n\r\n### 5. 插件管理 API\r\n\r\n位置: `src/app/api/plugins/`\r\n\r\n提供插件的 CRUD 操作 API，包括创建、读取、更新和删除插件。\r\n\r\n### 6. 插件管理界面\r\n\r\n位置: `src/app/[lang]/dashboard/plugins/`\r\n\r\n提供图形界面管理插件，包括启用/禁用、编辑和删除操作。\r\n\r\n## 插件类型和接口\r\n\r\n### 插件插槽\r\n\r\n系统定义了以下预定义插槽：\r\n\r\n| 插槽名称 | 位置 | 用途 |\r\n|---------|------|------|\r\n| `sidebar-top` | 侧边栏顶部 | 侧边栏顶部内容 |\r\n| `post-footer` | 文章底部 | 文章页脚内容 |\r\n| `post-sidebar` | 文章侧边栏 | 文章页面侧边栏内容 |\r\n| `navbar-end` | 导航栏右侧 | 导航栏右侧按钮或组件 |\r\n| `admin-dashboard` | 管理仪表板 | 管理界面内容 |\r\n| `footer-main` | 页面底部 | 网站页脚内容 |\r\n\r\n### ClientPlugin 接口\r\n\r\n```typescript\r\ninterface ClientPlugin {\r\n    id: string;                           // 插件唯一标识\r\n    name: string;                         // 插件名称\r\n    description?: string;                 // 插件描述\r\n    components?: Partial<Record<PluginSlot, React.ComponentType<any>>>; // 插槽到组件的映射\r\n    onLoad?: () => void;                  // 插件加载回调\r\n}\r\n```\r\n\r\n### 插件类型\r\n\r\n系统支持三种插件类型，这些类型主要用于管理界面的分类和显示：\r\n\r\n1. **主题插件 (theme)**: 影响应用外观和样式\r\n2. **功能插件 (feature)**: 添加新功能和行为\r\n3. **小组件 (widget)**: 小型 UI 组件\r\n\r\n## API 参考\r\n\r\n### 核心函数和组件\r\n\r\n#### useComponents Hook\r\n\r\n获取已注册的插件组件。\r\n\r\n```typescript\r\nimport { usePlugins } from '@/lib/plugins/context';\r\n\r\nconst { plugins, loading, error } = usePlugins();\r\n```\r\n\r\n#### PluginSlot 组件\r\n\r\n在应用中渲染特定插槽的插件组件。\r\n\r\n```typescript\r\nimport { PluginSlot } from '@/components/PluginSlot';\r\n\r\n// 在 JSX 中使用\r\n<PluginSlot name=\"post-sidebar\" />\r\n```\r\n\r\n#### registerPlugin 函数\r\n\r\n注册一个新插件到插件注册表。\r\n\r\n```typescript\r\nimport { registry } from '@/lib/plugins/registry';\r\n\r\nregistry['my-plugin'] = MyPlugin;\r\n```\r\n\r\n### 插件 API\r\n\r\n插件管理 API 提供以下端点：\r\n\r\n- `GET /api/plugins`: 获取当前用户的所有插件\r\n- `POST /api/plugins`: 创建新插件\r\n- `GET /api/plugins/[id]`: 获取特定插件\r\n- `PUT /api/plugins/[id]`: 更新插件\r\n- `DELETE /api/plugins/[id]`: 删除插件\r\n- `GET /api/plugins/active`: 获取所有启用的插件\r\n\r\n## 插件开发教程\r\n\r\n### 创建简单插件\r\n\r\n以下是一个创建简单插件的步骤示例：\r\n\r\n1. 创建插件目录和文件\r\n\r\n```bash\r\nmkdir src/plugins/my-plugin\r\ntouch src/plugins/my-plugin/index.tsx\r\n```\r\n\r\n2. 编写插件代码\r\n\r\n```typescript\r\n// src/plugins/my-plugin/index.tsx\r\nimport React from 'react';\r\nimport { ClientPlugin } from '@/lib/plugins/types';\r\n\r\n// 插件组件\r\nfunction MyComponent() {\r\n    return (\r\n        <div className=\"p-4 my-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n            <h3 className=\"font-bold\">我的插件</h3>\r\n            <p>这是通过插件系统注入的内容。</p>\r\n        </div>\r\n    );\r\n}\r\n\r\n// 插件定义\r\nexport const MyPlugin: ClientPlugin = {\r\n    id: 'my-plugin',\r\n    name: '我的插件',\r\n    description: '一个简单的示例插件',\r\n    components: {\r\n        'footer-main': MyComponent,\r\n    },\r\n    onLoad: () => {\r\n        console.log('我的插件已加载');\r\n    }\r\n};\r\n```\r\n\r\n3. 注册插件\r\n\r\n```typescript\r\n// src/lib/plugins/registry.ts\r\nimport { MyPlugin } from '@/plugins/my-plugin';\r\n\r\nexport const registry: PluginRegistry = {\r\n    // ... 其他插件\r\n    'my-plugin': MyPlugin,\r\n};\r\n```\r\n\r\n### 高级插件开发\r\n\r\n#### 使用状态和生命周期\r\n\r\n```typescript\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ClientPlugin } from '@/lib/plugins/types';\r\n\r\nfunction InteractiveComponent() {\r\n    const [count, setCount] = useState(0);\r\n\r\n    useEffect(() => {\r\n        // 组件挂载时的逻辑\r\n        const interval = setInterval(() => {\r\n            setCount(c => c + 1);\r\n        }, 1000);\r\n\r\n        return () => clearInterval(interval);\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n            <p>计数: {count}</p>\r\n            <button onClick={() => setCount(0)}>重置</button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport const AdvancedPlugin: ClientPlugin = {\r\n    id: 'advanced-plugin',\r\n    name: '高级插件',\r\n    description: '使用状态和生命周期的插件',\r\n    components: {\r\n        'sidebar-top': InteractiveComponent,\r\n    },\r\n    onLoad: () => {\r\n        // 插件加载时执行\r\n        console.log('高级插件已加载');\r\n    }\r\n};\r\n```\r\n\r\n#### 与 API 交互\r\n\r\n```typescript\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ClientPlugin } from '@/lib/plugins/types';\r\n\r\ninterface DataItem {\r\n    id: string;\r\n    title: string;\r\n    content: string;\r\n}\r\n\r\nfunction DataFetchingComponent() {\r\n    const [data, setData] = useState<DataItem[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetch('/api/data')\r\n            .then(res => res.json())\r\n            .then(setData)\r\n            .catch(console.error)\r\n            .finally(() => setLoading(false));\r\n    }, []);\r\n\r\n    if (loading) return <div>加载中...</div>;\r\n\r\n    return (\r\n        <div>\r\n            <h3>数据列表</h3>\r\n            <ul>\r\n                {data.map(item => (\r\n                    <li key={item.id}>{item.title}</li>\r\n                ))}\r\n            </ul>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport const DataPlugin: ClientPlugin = {\r\n    id: 'data-plugin',\r\n    name: '数据插件',\r\n    description: '从 API 获取数据的插件',\r\n    components: {\r\n        'admin-dashboard': DataFetchingComponent,\r\n    },\r\n};\r\n```\r\n\r\n## 插件管理和部署\r\n\r\n### 使用管理界面\r\n\r\n1. 访问 `/dashboard/plugins` 查看所有插件\r\n2. 点击\"创建插件\"按钮创建新插件\r\n3. 在插件列表中可以启用/禁用、编辑或删除插件\r\n\r\n### 插件配置\r\n\r\n每个插件在数据库中存储以下字段：\r\n\r\n- `name`: 插件名称\r\n- `slug`: 插件标识（唯一）\r\n- `description`: 插件描述\r\n- `type`: 插件类型（theme/feature/widget）\r\n- `code`: 插件代码（可选）\r\n- `styles`: 插件样式（可选）\r\n- `config`: 插件配置（JSON 格式）\r\n- `enabled`: 是否启用\r\n- `priority`: 优先级（数字越小优先级越高）\r\n\r\n### 部署插件\r\n\r\n插件的部署方式有两种：\r\n\r\n1. **代码部署**: 将插件代码添加到源代码中，并更新注册表\r\n2. **数据库部署**: 通过管理界面上传插件代码和配置\r\n\r\n代码部署的插件会在应用启动时自动加载，而数据库部署的插件可以在运行时动态加载。\r\n\r\n## 最佳实践\r\n\r\n### 1. 插件设计原则\r\n\r\n- **单一职责**: 每个插件应专注于一个特定功能\r\n- **轻量级**: 保持插件尽可能轻量，避免影响应用性能\r\n- **兼容性**: 确保插件与系统和其他插件的兼容性\r\n- **可配置**: 提供配置选项，允许用户自定义插件行为\r\n\r\n### 2. 代码组织\r\n\r\n```\r\nsrc/plugins/my-plugin/\r\n├── index.tsx          # 插件主文件\r\n├── components/        # 插件组件\r\n│   ├── Component1.tsx\r\n│   └── Component2.tsx\r\n├── hooks/            # 自定义 Hooks\r\n│   └── useData.ts\r\n├── utils/            # 工具函数\r\n│   └── helpers.ts\r\n└── types/            # 类型定义\r\n    └── index.ts\r\n```\r\n\r\n### 3. 性能优化\r\n\r\n- 使用 `React.memo` 优化组件渲染\r\n- 合理使用 `useEffect` 避免不必要的副作用\r\n- 懒加载大型组件\r\n- 避免在插件中进行重量级计算\r\n\r\n### 4. 错误处理\r\n\r\n```typescript\r\nexport const RobustPlugin: ClientPlugin = {\r\n    id: 'robust-plugin',\r\n    name: '健壮插件',\r\n    components: {\r\n        'sidebar-top': SafeComponent,\r\n    },\r\n    onLoad: () => {\r\n        try {\r\n            // 插件初始化逻辑\r\n            console.log('插件初始化成功');\r\n        } catch (error) {\r\n            console.error('插件初始化失败:', error);\r\n        }\r\n    }\r\n};\r\n\r\nfunction SafeComponent() {\r\n    return (\r\n        <ErrorBoundary fallback={<div>插件加载失败</div>}>\r\n            <MyComponent />\r\n        </ErrorBoundary>\r\n    );\r\n}\r\n```\r\n\r\n### 5. 样式管理\r\n\r\n- 使用 Tailwind CSS 类名保持一致性\r\n- 避免全局样式污染\r\n- 考虑暗色模式支持\r\n- 响应式设计\r\n\r\n## 故障排除\r\n\r\n### 常见问题\r\n\r\n1. **插件未显示**\r\n   - 检查插件是否已注册到注册表\r\n   - 确认插件已启用\r\n   - 验证插槽名称是否正确\r\n\r\n2. **组件错误**\r\n   - 检查组件语法是否正确\r\n   - 确认所有依赖已导入\r\n   - 查看浏览器控制台错误信息\r\n\r\n3. **性能问题**\r\n   - 使用 React DevTools 分析组件渲染\r\n   - 检查是否有不必要的重新渲染\r\n   - 优化大型列表渲染\r\n\r\n### 调试技巧\r\n\r\n1. 使用浏览器开发者工具检查组件层次\r\n2. 在插件代码中添加 `console.log` 调试\r\n3. 使用 React DevTools Profiler 分析性能\r\n4. 检查网络请求是否正常\r\n\r\n### 日志记录\r\n\r\n```typescript\r\nexport const DebugPlugin: ClientPlugin = {\r\n    id: 'debug-plugin',\r\n    name: '调试插件',\r\n    onLoad: () => {\r\n        console.log('插件加载开始');\r\n        // 插件初始化逻辑\r\n        console.log('插件加载完成');\r\n    },\r\n    components: {\r\n        'sidebar-top': () => {\r\n            console.log('组件渲染');\r\n            return <div>调试组件</div>;\r\n        }\r\n    }\r\n};\r\n```\r\n\r\n---\r\n\r\n## 现有插件示例\r\n\r\n### 目录导航插件 (TOC Plugin)\r\n\r\n位置: `src/plugins/toc/index.tsx`\r\n\r\n功能: 在文章侧边栏显示目录，支持点击跳转和滚动高亮\r\n\r\n特点:\r\n- 自动扫描页面标题生成目录\r\n- 滚动时自动高亮当前章节\r\n- 支持展开/收起\r\n- 响应式设计\r\n\r\n### 搜索框插件 (Search Box Plugin)\r\n\r\n位置: `src/plugins/search-box/index.tsx`\r\n\r\n功能: 提供全站文章搜索功能\r\n\r\n特点:\r\n- 支持 Ctrl/Cmd + K 快捷键\r\n- 实时搜索结果\r\n- 模态框界面\r\n- 多语言支持\r\n\r\n### Hello World 插件\r\n\r\n位置: `src/plugins/hello-world/index.tsx`\r\n\r\n功能: 简单的示例插件，展示基本插件结构\r\n\r\n特点:\r\n- 最小化实现\r\n- 适合作为插件开发起点\r\n\r\n---\r\n\r\n这份文档涵盖了 Quicksilver 插件系统的所有主要方面，为开发者提供了全面的指导和参考。无论是初学者还是经验丰富的开发者，都可以通过这份文档快速理解和使用插件系统，创建出功能丰富、性能优秀的插件。",
    "date": "2025-12-18T03:49:18.251Z",
    "author": "Mer6ury"
  },
  {
    "id": "test123",
    "title": "test123",
    "slug": "test123",
    "excerpt": "12321122313221332321",
    "content": "12321122313221332321\n",
    "date": "2025-12-18T02:49:18.251Z",
    "author": "Mer6ury"
  }
]